var documenterSearchIndex = {"docs":
[{"location":"models/kks/#KKS-Model-(Kim-Kim-Suzuki)","page":"KKS","title":"KKS Model (Kim-Kim-Suzuki)","text":"","category":"section"},{"location":"models/kks/#Overview","page":"KKS","title":"Overview","text":"The KKS model handles multi-phase, multi-component systems with local thermodynamic equilibrium at the interface. It avoids the artificial interface energy problem by partitioning the composition between phases.\n\nKey feature: Local equilibrium constraint ensures equal diffusion potentials between phases at each point.","category":"section"},{"location":"models/kks/#Mathematical-Formulation","page":"KKS","title":"Mathematical Formulation","text":"","category":"section"},{"location":"models/kks/#Phase-Field-Equation","page":"KKS","title":"Phase Field Equation","text":"tau fracpartial phipartial t = W^2 nabla^2 phi - g(phi) + h(phi) cdot Deltaomega","category":"section"},{"location":"models/kks/#Concentration-Equation","page":"KKS","title":"Concentration Equation","text":"fracpartial cpartial t = nabla cdot left( M(phi) nabla mu right)","category":"section"},{"location":"models/kks/#Local-Equilibrium-Constraints","page":"KKS","title":"Local Equilibrium Constraints","text":"At each point, the phase compositions (cs, cl) satisfy:\n\nc = h(phi) c_s + (1 - h(phi)) c_l quad text(mass conservation)\n\nmu_s(c_s) = mu_l(c_l) quad text(equal chemical potential)","category":"section"},{"location":"models/kks/#Grand-Potential-Difference","page":"KKS","title":"Grand Potential Difference","text":"Deltaomega = f_s(c_s) - f_l(c_l) - mu (c_s - c_l)","category":"section"},{"location":"models/kks/#Quick-Example","page":"KKS","title":"Quick Example","text":"","category":"section"},{"location":"models/kks/#Basic-Usage-with-Parabolic-Free-Energy","page":"KKS","title":"Basic Usage with Parabolic Free Energy","text":"using PhaseFields\n\n# Create model\nmodel = KKSModel(τ=1.0, W=1.0, m=1.0, M_s=1.0, M_l=10.0)\n\n# Parabolic free energies for testing\nf_s = ParabolicFreeEnergy(A=1.0, c_eq=0.2)  # Solid\nf_l = ParabolicFreeEnergy(A=1.0, c_eq=0.8)  # Liquid\n\n# Partition composition at interface\nc_avg = 0.5  # Average composition\nφ = 0.5      # At interface\n\nc_s, c_l, μ, converged = kks_partition(c_avg, φ, f_s, f_l)\nprintln(\"Solid: c_s = $c_s, Liquid: c_l = $c_l\")\n\n# Grand potential difference\nΔω = kks_grand_potential_diff(f_s, f_l, c_s, c_l, μ)","category":"section"},{"location":"models/kks/#With-CALPHAD-Thermodynamics","page":"KKS","title":"With CALPHAD Thermodynamics","text":"using PhaseFields\nusing OpenCALPHAD\n\n# Load database\ndb = read_tdb(\"AgCu.TDB\")\n\n# Create CALPHAD-coupled KKS model\nT = 1000.0  # Temperature [K]\nmodel, f_s, f_l = create_calphad_kks_model(db, T, \"FCC_A1\", \"LIQUID\")\n\n# Partition with real thermodynamics\nc_s, c_l, μ, converged = kks_partition(c_avg, φ, f_s, f_l)","category":"section"},{"location":"models/kks/#API-Reference","page":"KKS","title":"API Reference","text":"","category":"section"},{"location":"models/kks/#See-Also","page":"KKS","title":"See Also","text":"301kkssolidification.jl - KKS solidification simulation\n381calphadcoupling_demo.jl - KKS with CALPHAD thermodynamics","category":"section"},{"location":"models/kks/#PhaseFields.KKSModel","page":"KKS","title":"PhaseFields.KKSModel","text":"KKSModel\n\nKim-Kim-Suzuki model for solidification with local equilibrium.\n\nThe KKS model introduces phase concentrations (cs, cl) that satisfy:\n\nMass conservation: h(φ)·cs + (1-h(φ))·cl = c\nEqual diffusion potential: μs(cs, T) = μl(cl, T)\n\nEvolution equations:\n\nPhase field:  τ·∂φ/∂t = W²∇²φ - g'(φ) + h'(φ)·Δω\nConcentration: ∂c/∂t = ∇·(M(φ)·∇μ)\n\nwhere Δω = fs(cs) - fl(cl) - μ·(cs - cl) is the grand potential difference.\n\nFields\n\nτ::Float64: Relaxation time [s]\nW::Float64: Interface width parameter [m]\nm::Float64: Driving force scale (typically 1.0 for KKS)\nM_s::Float64: Mobility in solid phase [m²/(J·s)]\nM_l::Float64: Mobility in liquid phase [m²/(J·s)]\n\nExample\n\nmodel = KKSModel(τ=1.0, W=1.0, m=1.0, M_s=1.0, M_l=10.0)\n\nReference\n\nKim, Kim, Suzuki, Phys. Rev. E 60 (1999) 7186\n\n\n\n\n\n","category":"type"},{"location":"models/kks/#PhaseFields.ParabolicFreeEnergy","page":"KKS","title":"PhaseFields.ParabolicFreeEnergy","text":"ParabolicFreeEnergy\n\nSimple parabolic free energy for testing KKS model.\n\nf(c) = A·(c - c_eq)²\n\nFields\n\nA::Float64: Curvature (must be positive for stability)\nc_eq::Float64: Equilibrium concentration\n\n\n\n\n\n","category":"type"},{"location":"models/kks/#PhaseFields.free_energy","page":"KKS","title":"PhaseFields.free_energy","text":"free_energy(f::ParabolicFreeEnergy, c)\n\nParabolic free energy density: f(c) = A·(c - c_eq)²\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.chemical_potential","page":"KKS","title":"PhaseFields.chemical_potential","text":"chemical_potential(f::ParabolicFreeEnergy, c)\n\nChemical potential (first derivative): df/dc = 2A·(c - c_eq)\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.d2f_dc2","page":"KKS","title":"PhaseFields.d2f_dc2","text":"d2f_dc2(f::ParabolicFreeEnergy, c)\n\nSecond derivative of free energy: d²f/dc² = 2A\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.kks_partition","page":"KKS","title":"PhaseFields.kks_partition","text":"kks_partition(c_avg, φ, f_s, f_l; maxiter=50, tol=1e-12, φ_min=1e-8)\n\nSolve the KKS local equilibrium problem using Newton iteration.\n\nGiven average concentration c and phase fraction φ, find phase concentrations (cs, cl) that satisfy:\n\nh(φ)·cs + (1-h(φ))·cl = c  (mass conservation)\nμs(cs) = μl(cl)         (equal chemical potential)\n\nArguments\n\nc_avg: Average concentration at this point\nφ: Phase field value (0=liquid, 1=solid)\nf_s: Solid phase free energy (ParabolicFreeEnergy or similar)\nf_l: Liquid phase free energy\n\nKeyword Arguments\n\nmaxiter: Maximum Newton iterations (default: 50)\ntol: Convergence tolerance (default: 1e-12)\nφ_min: Minimum φ for Newton iteration (default: 1e-8)\n\nReturns\n\n(c_s, c_l, μ, converged): Phase concentrations, chemical potential, convergence flag\n\nExample\n\nf_s = ParabolicFreeEnergy(A=1000.0, c_eq=0.1)  # Solid equilibrium at c=0.1\nf_l = ParabolicFreeEnergy(A=1000.0, c_eq=0.9)  # Liquid equilibrium at c=0.9\n\nc_s, c_l, μ, converged = kks_partition(0.5, 0.5, f_s, f_l)\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.kks_grand_potential_diff","page":"KKS","title":"PhaseFields.kks_grand_potential_diff","text":"kks_grand_potential_diff(f_s, f_l, c_s, c_l, μ)\n\nCompute the grand potential difference (driving force for phase field).\n\nΔω = f_s(c_s) - f_l(c_l) - μ·(c_s - c_l)\n\nArguments\n\nf_s, f_l: Solid and liquid free energy functions\nc_s, c_l: Phase concentrations\nμ: Chemical potential (equal in both phases)\n\nReturns\n\nGrand potential difference Δω [J/mol]\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.kks_phase_rhs","page":"KKS","title":"PhaseFields.kks_phase_rhs","text":"kks_phase_rhs(model, φ, ∇²φ, Δω)\n\nCompute the right-hand side of the KKS phase field equation.\n\nτ·∂φ/∂t = W²∇²φ - g'(φ) + m·h'(φ)·Δω\n⟹ ∂φ/∂t = [W²∇²φ - g'(φ) + m·h'(φ)·Δω] / τ\n\nArguments\n\nmodel: KKSModel parameters\nφ: Phase field value\n∇²φ: Laplacian of phase field\nΔω: Grand potential difference from kksgrandpotential_diff\n\nReturns\n\nTime derivative ∂φ/∂t\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.kks_concentration_rhs","page":"KKS","title":"PhaseFields.kks_concentration_rhs","text":"kks_concentration_rhs(model, φ, ∇²μ)\n\nCompute the right-hand side of the KKS concentration equation.\n\n∂c/∂t = ∇·(M(φ)·∇μ) ≈ M(φ)·∇²μ  (for constant mobility in each phase)\n\nArguments\n\nmodel: KKSModel parameters\nφ: Phase field value (for mobility interpolation)\n∇²μ: Laplacian of chemical potential\n\nReturns\n\nTime derivative ∂c/∂t\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.kks_mobility","page":"KKS","title":"PhaseFields.kks_mobility","text":"kks_mobility(model, φ)\n\nCompute effective mobility using interpolation.\n\nM(φ) = h(φ)·M_s + (1-h(φ))·M_l\n\nReturns\n\nEffective mobility at this phase field value\n\n\n\n\n\n","category":"function"},{"location":"models/kks/#PhaseFields.kks_interface_width","page":"KKS","title":"PhaseFields.kks_interface_width","text":"kks_interface_width(model)\n\nGet the interface width parameter W.\n\n\n\n\n\n","category":"function"},{"location":"models/cahn_hilliard/#Cahn-Hilliard-Model","page":"Cahn-Hilliard","title":"Cahn-Hilliard Model","text":"","category":"section"},{"location":"models/cahn_hilliard/#Overview","page":"Cahn-Hilliard","title":"Overview","text":"The Cahn-Hilliard equation describes the evolution of a conserved order parameter. It is used for modeling spinodal decomposition, phase separation, and coarsening.\n\nThe concentration field c represents the local composition (mole fraction).","category":"section"},{"location":"models/cahn_hilliard/#Mathematical-Formulation","page":"Cahn-Hilliard","title":"Mathematical Formulation","text":"The Cahn-Hilliard equation:\n\nfracpartial cpartial t = M nabla^2 mu\n\nwhere the chemical potential μ is:\n\nmu = fracdfdc - kappa nabla^2 c\n\nParameters:\n\nM: Mobility coefficient\nκ: Gradient energy coefficient\nf(c): Bulk free energy density (e.g., double-well)\n\nCombining these gives the 4th-order equation:\n\nfracpartial cpartial t = M nabla^2 left( fracdfdc right) - M kappa nabla^4 c","category":"section"},{"location":"models/cahn_hilliard/#Quick-Example","page":"Cahn-Hilliard","title":"Quick Example","text":"","category":"section"},{"location":"models/cahn_hilliard/#Basic-Usage","page":"Cahn-Hilliard","title":"Basic Usage","text":"using PhaseFields\n\n# Create model and free energy\nmodel = CahnHilliardModel(M=1.0, κ=1.0)\nf = DoubleWellFreeEnergy(A=1.0, c_eq_α=0.2, c_eq_β=0.8)\n\n# Compute chemical potential\nc = 0.5\n∇²c = -0.01\nμ = cahn_hilliard_chemical_potential(f, model, c, ∇²c)\n\n# Compute concentration change rate\n∇²μ = 0.001\ndcdt = cahn_hilliard_rhs(model, ∇²μ)","category":"section"},{"location":"models/cahn_hilliard/#Free-Energy-Functions","page":"Cahn-Hilliard","title":"Free Energy Functions","text":"# Double-well free energy: f(c) = A(c - c_α)²(c - c_β)²\nf = DoubleWellFreeEnergy(A=1.0, c_eq_α=0.2, c_eq_β=0.8)\n\n# Evaluate\nenergy = free_energy_density(f, 0.5)\nμ_bulk = chemical_potential_bulk(f, 0.5)","category":"section"},{"location":"models/cahn_hilliard/#Interface-Properties","page":"Cahn-Hilliard","title":"Interface Properties","text":"# Estimate interface width\nW = cahn_hilliard_interface_width(model, f)\n\n# Stability constraint for explicit time stepping\ndt_max = cahn_hilliard_stability_dt(model, f, dx)","category":"section"},{"location":"models/cahn_hilliard/#API-Reference","page":"Cahn-Hilliard","title":"API Reference","text":"","category":"section"},{"location":"models/cahn_hilliard/#See-Also","page":"Cahn-Hilliard","title":"See Also","text":"201spinodal1d.jl - 1D spinodal decomposition\n401ostwaldripening.jl - Ostwald ripening (multi-particle coarsening)","category":"section"},{"location":"models/cahn_hilliard/#PhaseFields.CahnHilliardModel","page":"Cahn-Hilliard","title":"PhaseFields.CahnHilliardModel","text":"CahnHilliardModel\n\nCahn-Hilliard model for conserved order parameter (concentration) evolution.\n\nThe Cahn-Hilliard equation:     ∂c/∂t = ∇·(M∇μ)     μ = df/dc - κ∇²c\n\nwhere:\n\nc: Concentration field (conserved quantity)\nM: Mobility [m²/(J·s)]\nκ: Gradient energy coefficient [J·m²/mol] or [J/m] depending on normalization\nμ: Chemical potential [J/mol]\nf(c): Bulk free energy density [J/mol]\n\nFields\n\nM::Float64: Mobility\nκ::Float64: Gradient energy coefficient\n\nExample\n\nmodel = CahnHilliardModel(M=5.0, κ=2.0)\n\n\n\n\n\n","category":"type"},{"location":"models/cahn_hilliard/#PhaseFields.DoubleWellFreeEnergy","page":"Cahn-Hilliard","title":"PhaseFields.DoubleWellFreeEnergy","text":"DoubleWellFreeEnergy\n\nSymmetric double-well free energy density for binary phase separation.\n\nf(c) = ρs · (c - cα)² · (cβ - c)²\n\nMinima at c = cα (α-phase) and c = cβ (β-phase).\n\nFields\n\nρs::Float64: Barrier height [J/mol]\ncα::Float64: α-phase equilibrium concentration\ncβ::Float64: β-phase equilibrium concentration\n\nExample\n\n# PFHub BM1 parameters\nf = DoubleWellFreeEnergy(ρs=5.0, cα=0.3, cβ=0.7)\n\n\n\n\n\n","category":"type"},{"location":"models/cahn_hilliard/#PhaseFields.free_energy_density","page":"Cahn-Hilliard","title":"PhaseFields.free_energy_density","text":"free_energy_density(f::DoubleWellFreeEnergy, c::T) where T<:Real\n\nCompute bulk free energy density f(c).\n\nf(c) = ρs · (c - cα)² · (cβ - c)²\n\nThis function is AD-compatible.\n\nArguments\n\nf: DoubleWellFreeEnergy parameters\nc: Concentration\n\nReturns\n\nFree energy density [J/mol]\n\nExample\n\nf = DoubleWellFreeEnergy(ρs=5.0, cα=0.3, cβ=0.7)\nenergy = free_energy_density(f, 0.5)  # At spinodal point\n\n\n\n\n\n","category":"function"},{"location":"models/cahn_hilliard/#PhaseFields.chemical_potential_bulk","page":"Cahn-Hilliard","title":"PhaseFields.chemical_potential_bulk","text":"chemical_potential_bulk(f::DoubleWellFreeEnergy, c::T) where T<:Real\n\nCompute bulk chemical potential df/dc.\n\ndf/dc = 2ρs · (c - cα) · (cβ - c) · (cα + cβ - 2c)\n\nThis function is AD-compatible.\n\nArguments\n\nf: DoubleWellFreeEnergy parameters\nc: Concentration\n\nReturns\n\nBulk chemical potential [J/mol]\n\nExample\n\nf = DoubleWellFreeEnergy(ρs=5.0, cα=0.3, cβ=0.7)\nμ_bulk = chemical_potential_bulk(f, 0.5)  # = 0 at c = (cα+cβ)/2\n\n\n\n\n\n","category":"function"},{"location":"models/cahn_hilliard/#PhaseFields.cahn_hilliard_chemical_potential","page":"Cahn-Hilliard","title":"PhaseFields.cahn_hilliard_chemical_potential","text":"cahn_hilliard_chemical_potential(model::CahnHilliardModel, f::DoubleWellFreeEnergy,\n                                 c::T, ∇²c::T) where T<:Real\n\nCompute total chemical potential including gradient term.\n\nμ = df/dc - κ∇²c\n\nArguments\n\nmodel: CahnHilliardModel parameters\nf: DoubleWellFreeEnergy for bulk contribution\nc: Concentration at current point\n∇²c: Laplacian of concentration\n\nReturns\n\nTotal chemical potential [J/mol]\n\nExample\n\nmodel = CahnHilliardModel(M=5.0, κ=2.0)\nf = DoubleWellFreeEnergy(ρs=5.0, cα=0.3, cβ=0.7)\nμ = cahn_hilliard_chemical_potential(model, f, 0.5, -0.01)\n\n\n\n\n\n","category":"function"},{"location":"models/cahn_hilliard/#PhaseFields.cahn_hilliard_rhs","page":"Cahn-Hilliard","title":"PhaseFields.cahn_hilliard_rhs","text":"cahn_hilliard_rhs(model::CahnHilliardModel, ∇²μ::T) where T<:Real\n\nCompute the right-hand side of the Cahn-Hilliard equation.\n\n∂c/∂t = M∇²μ\n\nNote: This assumes ∇·(M∇μ) ≈ M∇²μ for constant mobility.\n\nArguments\n\nmodel: CahnHilliardModel parameters\n∇²μ: Laplacian of chemical potential\n\nReturns\n\nTime derivative ∂c/∂t\n\nExample\n\nmodel = CahnHilliardModel(M=5.0, κ=2.0)\ndcdt = cahn_hilliard_rhs(model, 100.0)\n\n\n\n\n\n","category":"function"},{"location":"models/cahn_hilliard/#PhaseFields.cahn_hilliard_interface_width","page":"Cahn-Hilliard","title":"PhaseFields.cahn_hilliard_interface_width","text":"cahn_hilliard_interface_width(model::CahnHilliardModel, f::DoubleWellFreeEnergy)\n\nEstimate equilibrium interface width.\n\nW ≈ √(κ / (ρs · (cβ - cα)²))\n\nArguments\n\nmodel: CahnHilliardModel parameters\nf: DoubleWellFreeEnergy parameters\n\nReturns\n\nApproximate interface width\n\n\n\n\n\n","category":"function"},{"location":"models/cahn_hilliard/#PhaseFields.cahn_hilliard_stability_dt","page":"Cahn-Hilliard","title":"PhaseFields.cahn_hilliard_stability_dt","text":"cahn_hilliard_stability_dt(model::CahnHilliardModel, dx::Float64)\n\nEstimate maximum stable time step for explicit Euler scheme.\n\nFor the 4th-order Cahn-Hilliard equation, stability requires:     dt < dx⁴ / (16 · M · κ)\n\nArguments\n\nmodel: CahnHilliardModel parameters\ndx: Grid spacing\n\nReturns\n\nMaximum stable time step\n\nExample\n\nmodel = CahnHilliardModel(M=5.0, κ=2.0)\ndt_max = cahn_hilliard_stability_dt(model, 1.0)  # ≈ 0.00625\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#DifferentialEquations.jl-Integration","page":"DifferentialEquations.jl","title":"DifferentialEquations.jl Integration","text":"","category":"section"},{"location":"integration/diffeq/#Overview","page":"DifferentialEquations.jl","title":"Overview","text":"PhaseFields.jl integrates with DifferentialEquations.jl using the Method of Lines approach:\n\nDiscretize space with finite differences\nConvert PDE to system of ODEs\nSolve with adaptive time stepping","category":"section"},{"location":"integration/diffeq/#Grid-and-Boundary-Conditions","page":"DifferentialEquations.jl","title":"Grid and Boundary Conditions","text":"","category":"section"},{"location":"integration/diffeq/#Uniform-Grid","page":"DifferentialEquations.jl","title":"Uniform Grid","text":"using PhaseFields\n\n# Create 1D uniform grid\ngrid = UniformGrid1D(N=101, L=1.0)  # 101 points, length 1.0\n\n# Access properties\ngrid.N    # Number of points\ngrid.L    # Domain length\ngrid.dx   # Grid spacing\ngrid.x    # Coordinate array","category":"section"},{"location":"integration/diffeq/#Boundary-Conditions","page":"DifferentialEquations.jl","title":"Boundary Conditions","text":"# Neumann (zero-flux)\nbc = NeumannBC()\n\n# Dirichlet (fixed values)\nbc = DirichletBC(left=0.0, right=1.0)\n\n# Periodic\nbc = PeriodicBC()","category":"section"},{"location":"integration/diffeq/#Laplacian-Operator","page":"DifferentialEquations.jl","title":"Laplacian Operator","text":"# In-place computation\n∇²φ = zeros(grid.N)\nlaplacian_1d!(∇²φ, φ, grid.dx, bc)\n\n# Allocating version\n∇²φ = laplacian_1d(φ, grid.dx, bc)\n\n# Sparse matrix form (for implicit solvers)\nL = laplacian_matrix_1d(grid.N, grid.dx, bc)","category":"section"},{"location":"integration/diffeq/#Callbacks","page":"DifferentialEquations.jl","title":"Callbacks","text":"","category":"section"},{"location":"integration/diffeq/#Interface-Tracking","page":"DifferentialEquations.jl","title":"Interface Tracking","text":"using PhaseFields\nusing OrdinaryDiffEq\n\n# Track interface position during simulation\ncb, saved = create_interface_saving_callback(grid; saveat=0.1)\n\nsol = solve(prob, Tsit5(); callback=cb)\n\n# Access results\ntimes = saved.t\npositions = saved.saveval","category":"section"},{"location":"integration/diffeq/#Solid-Fraction-Tracking","page":"DifferentialEquations.jl","title":"Solid Fraction Tracking","text":"cb, saved = create_solid_fraction_callback(; threshold=0.5, saveat=0.1)\n\nsol = solve(prob, Tsit5(); callback=cb)\nfractions = saved.saveval","category":"section"},{"location":"integration/diffeq/#Steady-State-Termination","page":"DifferentialEquations.jl","title":"Steady State Termination","text":"# Stop when solution reaches steady state\ncb = create_steady_state_callback(abstol=1e-6, reltol=1e-4, min_t=1.0)\n\nsol = solve(prob, Tsit5(); callback=cb)\n# sol.t[end] is when steady state was reached","category":"section"},{"location":"integration/diffeq/#Combined-Callbacks","page":"DifferentialEquations.jl","title":"Combined Callbacks","text":"result = create_phase_field_callbacks(grid;\n    track_interface=true,\n    track_solid_fraction=true,\n    terminate_steady_state=true,\n    saveat=0.1)\n\nsol = solve(prob, Tsit5(); callback=result.callback)\n\n# Access tracked data\nresult.interface_data.t\nresult.interface_data.saveval\nresult.solid_fraction_data.saveval","category":"section"},{"location":"integration/diffeq/#Solver-Selection","page":"DifferentialEquations.jl","title":"Solver Selection","text":"","category":"section"},{"location":"integration/diffeq/#Explicit-Solvers-(Non-stiff)","page":"DifferentialEquations.jl","title":"Explicit Solvers (Non-stiff)","text":"# Tsit5: Good general-purpose choice\nsol = solve(prob, Tsit5())\n\n# Vern7: Higher accuracy\nsol = solve(prob, Vern7())","category":"section"},{"location":"integration/diffeq/#Implicit-Solvers-(Stiff)","page":"DifferentialEquations.jl","title":"Implicit Solvers (Stiff)","text":"For thermal coupling or fine grids:\n\n# QNDF: Quasi-constant step BDF (recommended)\nsol = solve(prob, QNDF(autodiff=false))\n\n# Rodas5: Rosenbrock method\nsol = solve(prob, Rodas5(autodiff=false))\n\nNote: Use autodiff=false with pre-allocated workspaces.","category":"section"},{"location":"integration/diffeq/#API-Reference","page":"DifferentialEquations.jl","title":"API Reference","text":"","category":"section"},{"location":"integration/diffeq/#Grid-and-Boundary-Conditions-2","page":"DifferentialEquations.jl","title":"Grid and Boundary Conditions","text":"","category":"section"},{"location":"integration/diffeq/#Callbacks-2","page":"DifferentialEquations.jl","title":"Callbacks","text":"","category":"section"},{"location":"integration/diffeq/#See-Also","page":"DifferentialEquations.jl","title":"See Also","text":"151diffeqallen_cahn.jl - Allen-Cahn with callbacks and analysis\n351diffeqthermal_solidification.jl - Thermal solidification with implicit solver","category":"section"},{"location":"integration/diffeq/#PhaseFields.UniformGrid1D","page":"DifferentialEquations.jl","title":"PhaseFields.UniformGrid1D","text":"UniformGrid1D\n\n1D uniform grid for finite difference discretization.\n\nFields\n\nN::Int: Number of grid points\nL::Float64: Domain length\ndx::Float64: Grid spacing (computed)\nx::Vector{Float64}: Grid point coordinates\n\nExample\n\ngrid = UniformGrid1D(N=100, L=1.0)\ngrid isa AbstractDomain{1}  # true\n\n\n\n\n\n","category":"type"},{"location":"integration/diffeq/#PhaseFields.BoundaryCondition","page":"DifferentialEquations.jl","title":"PhaseFields.BoundaryCondition","text":"BoundaryCondition\n\nAbstract type for boundary conditions.\n\n\n\n\n\n","category":"type"},{"location":"integration/diffeq/#PhaseFields.NeumannBC","page":"DifferentialEquations.jl","title":"PhaseFields.NeumannBC","text":"NeumannBC\n\nZero-flux (Neumann) boundary condition: ∂u/∂n = 0.\n\n\n\n\n\n","category":"type"},{"location":"integration/diffeq/#PhaseFields.DirichletBC","page":"DifferentialEquations.jl","title":"PhaseFields.DirichletBC","text":"DirichletBC\n\nFixed value (Dirichlet) boundary condition for 1D.\n\nFields\n\nleft::Float64: Value at left boundary\nright::Float64: Value at right boundary\n\n\n\n\n\n","category":"type"},{"location":"integration/diffeq/#PhaseFields.PeriodicBC","page":"DifferentialEquations.jl","title":"PhaseFields.PeriodicBC","text":"PeriodicBC\n\nPeriodic boundary condition: u(0) = u(L).\n\n\n\n\n\n","category":"type"},{"location":"integration/diffeq/#PhaseFields.laplacian_1d!","page":"DifferentialEquations.jl","title":"PhaseFields.laplacian_1d!","text":"laplacian_1d!(∇²u, u, dx, bc::BoundaryCondition)\n\nCompute 1D Laplacian in-place using second-order central differences.\n\nArguments\n\n∇²u: Output array for Laplacian values (modified in-place)\nu: Input field values\ndx: Grid spacing\nbc: Boundary condition\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.laplacian_1d","page":"DifferentialEquations.jl","title":"PhaseFields.laplacian_1d","text":"laplacian_1d(u, dx, bc::BoundaryCondition)\n\nCompute 1D Laplacian (allocating version).\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.laplacian_matrix_1d","page":"DifferentialEquations.jl","title":"PhaseFields.laplacian_matrix_1d","text":"laplacian_matrix_1d(N, dx, bc::BoundaryCondition)\n\nCreate sparse Laplacian matrix for 1D finite differences.\n\nReturns sparse matrix L such that L * u ≈ ∇²u.\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.interface_position_1d","page":"DifferentialEquations.jl","title":"PhaseFields.interface_position_1d","text":"interface_position_1d(φ, x; contour=0.5)\n\nFind the position where φ crosses the contour value using linear interpolation.\n\nArguments\n\nφ: Phase field array\nx: Spatial coordinates array\n\nKeyword Arguments\n\ncontour: Contour value to track (default: 0.5)\n\nReturns\n\nInterface position, or NaN if no crossing found\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.solid_fraction","page":"DifferentialEquations.jl","title":"PhaseFields.solid_fraction","text":"solid_fraction(φ; threshold=0.5)\n\nCalculate the fraction of the domain in the solid phase (φ > threshold).\n\nArguments\n\nφ: Phase field array\n\nKeyword Arguments\n\nthreshold: Value above which a point is considered solid (default: 0.5)\n\nReturns\n\nSolid fraction (0 to 1)\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.create_interface_saving_callback","page":"DifferentialEquations.jl","title":"PhaseFields.create_interface_saving_callback","text":"create_interface_saving_callback(grid; contour=0.5, saveat=nothing, save_everystep=true)\n\nCreate a SavingCallback that tracks interface position during integration.\n\nArguments\n\ngrid: UniformGrid1D object\n\nKeyword Arguments\n\ncontour: Contour value to track (default: 0.5)\nsaveat: Specific times to save (default: nothing, uses save_everystep)\nsave_everystep: Save at every solver step (default: true if saveat is empty)\n\nReturns\n\nTuple of (callback, saved_values)\n\nExample\n\ncb, saved = create_interface_saving_callback(grid; saveat=0.1)\nsol = solve(prob, Tsit5(); callback=cb)\n# Access results:\ntimes = saved.t\npositions = saved.saveval\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.create_solid_fraction_callback","page":"DifferentialEquations.jl","title":"PhaseFields.create_solid_fraction_callback","text":"create_solid_fraction_callback(; threshold=0.5, saveat=nothing, save_everystep=true)\n\nCreate a SavingCallback that tracks solid fraction during integration.\n\nKeyword Arguments\n\nthreshold: Value above which a point is considered solid (default: 0.5)\nsaveat: Specific times to save (default: nothing)\nsave_everystep: Save at every solver step (default: true if saveat is empty)\n\nReturns\n\nTuple of (callback, saved_values)\n\nExample\n\ncb, saved = create_solid_fraction_callback(; saveat=0.1)\nsol = solve(prob, Tsit5(); callback=cb)\n# Access results:\ntimes = saved.t\nfractions = saved.saveval\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.create_steady_state_callback","page":"DifferentialEquations.jl","title":"PhaseFields.create_steady_state_callback","text":"create_steady_state_callback(; abstol=1e-8, reltol=1e-6, min_t=nothing)\n\nCreate a TerminateSteadyState callback that stops integration when the solution reaches steady state.\n\nKeyword Arguments\n\nabstol: Absolute tolerance for derivatives (default: 1e-8)\nreltol: Relative tolerance for derivatives (default: 1e-6)\nmin_t: Minimum time before termination is allowed (default: nothing)\n\nReturns\n\nTerminateSteadyState callback\n\nExample\n\ncb = create_steady_state_callback(abstol=1e-6, reltol=1e-4, min_t=1.0)\nsol = solve(prob, Tsit5(); callback=cb)\n# sol.t[end] will be the time when steady state was reached\n\n\n\n\n\n","category":"function"},{"location":"integration/diffeq/#PhaseFields.create_phase_field_callbacks","page":"DifferentialEquations.jl","title":"PhaseFields.create_phase_field_callbacks","text":"create_phase_field_callbacks(grid;\n    track_interface=true, track_solid_fraction=false,\n    terminate_steady_state=false, kwargs...)\n\nCreate a combined set of callbacks for phase field simulations.\n\nArguments\n\ngrid: UniformGrid1D object (required if track_interface=true)\n\nKeyword Arguments\n\ntrack_interface: Track interface position (default: true)\ntrack_solid_fraction: Track solid fraction (default: false)\nterminate_steady_state: Enable steady state termination (default: false)\ncontour: Contour value for interface tracking (default: 0.5)\nthreshold: Threshold for solid fraction (default: 0.5)\nsaveat: Times to save tracked values (default: nothing)\nabstol: Steady state absolute tolerance (default: 1e-8)\nreltol: Steady state relative tolerance (default: 1e-6)\nmin_t: Minimum time before steady state termination (default: nothing)\n\nReturns\n\nNamed tuple with:\ncallback: Combined CallbackSet\ninterface_data: SavedValues for interface (or nothing)\nsolid_fraction_data: SavedValues for solid fraction (or nothing)\n\nExample\n\nresult = create_phase_field_callbacks(grid;\n    track_interface=true,\n    terminate_steady_state=true,\n    saveat=0.1)\n\nsol = solve(prob, Tsit5(); callback=result.callback)\n\n# Access tracked data\ninterface_times = result.interface_data.t\ninterface_positions = result.interface_data.saveval\n\n\n\n\n\n","category":"function"},{"location":"getting_started/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"This guide covers the basic concepts of PhaseFields.jl.","category":"section"},{"location":"getting_started/#Phase-Field-Method-Overview","page":"Getting Started","title":"Phase Field Method Overview","text":"The phase field method represents interfaces using a continuous order parameter φ:\n\nφ = 1: Solid phase\nφ = 0: Liquid phase\n0 < φ < 1: Diffuse interface region\n\nThis approach avoids explicit interface tracking and naturally handles topological changes like merging and splitting.","category":"section"},{"location":"getting_started/#Available-Models","page":"Getting Started","title":"Available Models","text":"PhaseFields.jl provides several phase field models for different applications:\n\nModel Application Order Parameter\nAllen-Cahn Solidification, grain growth Non-conserved\nCahn-Hilliard Spinodal decomposition Conserved\nKKS Multi-component alloys Local equilibrium\nWBM Dilute alloys Mixture rule\nThermal Solidification with heat Coupled φ-T","category":"section"},{"location":"getting_started/#Quick-Example","page":"Getting Started","title":"Quick Example","text":"using PhaseFields\nusing OrdinaryDiffEq\n\n# 1. Create model\nmodel = AllenCahnModel(τ=1.0, W=0.05)\n\n# 2. Set up spatial grid\ngrid = UniformGrid1D(N=101, L=1.0)\nbc = NeumannBC()\n\n# 3. Initial condition\nφ0 = [0.5 * (1 - tanh((x - 0.3) / 0.1)) for x in grid.x]\n\n# 4. Create ODE problem\nprob = create_allen_cahn_problem(model, grid, bc, φ0, (0.0, 2.0))\n\n# 5. Solve\nsol = solve(prob, Tsit5())","category":"section"},{"location":"getting_started/#Key-Concepts","page":"Getting Started","title":"Key Concepts","text":"","category":"section"},{"location":"getting_started/#Interpolation-and-Double-Well-Functions","page":"Getting Started","title":"Interpolation and Double-Well Functions","text":"All models use:\n\nh(φ): Interpolation function (0→1 transition)\ng(φ): Double-well potential (energy barrier)\n\n# Standard choices\nh = h_polynomial(φ)  # 3φ² - 2φ³\ng = g_standard(φ)    # φ²(1-φ)²\n\nSee Common API Reference for details.","category":"section"},{"location":"getting_started/#DifferentialEquations.jl-Integration","page":"Getting Started","title":"DifferentialEquations.jl Integration","text":"PhaseFields.jl uses Method of Lines for time integration:\n\nusing OrdinaryDiffEq\n\n# Explicit solver (fast, non-stiff)\nsol = solve(prob, Tsit5())\n\n# Implicit solver (stiff problems)\nsol = solve(prob, QNDF(autodiff=false))\n\nSee DifferentialEquations.jl Integration for details.","category":"section"},{"location":"getting_started/#CALPHAD-Coupling-(Optional)","page":"Getting Started","title":"CALPHAD Coupling (Optional)","text":"For realistic thermodynamics:\n\nusing PhaseFields\nusing OpenCALPHAD  # Activates extension\n\ndb = read_tdb(\"AgCu.TDB\")\nΔG = calphad_driving_force(db, 1000.0, 0.3, \"FCC_A1\", \"LIQUID\")\n\nSee CALPHAD Coupling for details.","category":"section"},{"location":"getting_started/#Next-Steps","page":"Getting Started","title":"Next Steps","text":"Explore specific Models\nLearn about DifferentialEquations.jl Integration\nSet up CALPHAD Coupling","category":"section"},{"location":"integration/calphad/#CALPHAD-Coupling","page":"CALPHAD Coupling","title":"CALPHAD Coupling","text":"","category":"section"},{"location":"integration/calphad/#Overview","page":"CALPHAD Coupling","title":"Overview","text":"PhaseFields.jl provides optional integration with OpenCALPHAD.jl for realistic thermodynamic calculations. This coupling is implemented as a Julia package extension that loads automatically when OpenCALPHAD is imported.","category":"section"},{"location":"integration/calphad/#Installation","page":"CALPHAD Coupling","title":"Installation","text":"using Pkg\nPkg.add(url=\"https://github.com/hsugawa8651/OpenCALPHAD.jl\")","category":"section"},{"location":"integration/calphad/#Basic-Usage","page":"CALPHAD Coupling","title":"Basic Usage","text":"using PhaseFields\nusing OpenCALPHAD  # Activates extension automatically\n\n# Load thermodynamic database\ndb = read_tdb(\"AgCu.TDB\")\n\n# Calculate driving force\nT = 1000.0  # Temperature [K]\nx = 0.3     # Composition (Cu mole fraction)\nΔG = calphad_driving_force(db, T, x, \"FCC_A1\", \"LIQUID\")","category":"section"},{"location":"integration/calphad/#CALPHAD-Coupled-Models","page":"CALPHAD Coupling","title":"CALPHAD-Coupled Models","text":"","category":"section"},{"location":"integration/calphad/#Allen-Cahn-with-CALPHAD","page":"CALPHAD Coupling","title":"Allen-Cahn with CALPHAD","text":"using PhaseFields\nusing OpenCALPHAD\n\ndb = read_tdb(\"AgCu.TDB\")\nT = 1000.0\nx = 0.3\n\n# Create coupled model\nmodel = create_calphad_allen_cahn(db, T, x, \"FCC_A1\", \"LIQUID\";\n    τ = 1.0,\n    W = 1.0,\n    m = 1e-4  # Scaling factor for ΔG\n)\n\n# The model caches the driving force from CALPHAD","category":"section"},{"location":"integration/calphad/#KKS-with-CALPHAD","page":"CALPHAD Coupling","title":"KKS with CALPHAD","text":"db = read_tdb(\"AgCu.TDB\")\nT = 1000.0\n\n# Create model with CALPHAD free energies\nmodel, f_s, f_l = create_calphad_kks_model(db, T, \"FCC_A1\", \"LIQUID\";\n    τ = 1.0,\n    W = 1.0,\n    m = 1.0,\n    M_s = 1.0,\n    M_l = 10.0\n)\n\n# Partition with real thermodynamics\nc_avg = 0.3\nφ = 0.5\nc_s, c_l, μ, converged = kks_partition(c_avg, φ, f_s, f_l)","category":"section"},{"location":"integration/calphad/#WBM-with-CALPHAD","page":"CALPHAD Coupling","title":"WBM with CALPHAD","text":"db = read_tdb(\"AgCu.TDB\")\nT = 1000.0\n\nmodel, f_s, f_l = create_calphad_wbm_model(db, T, \"FCC_A1\", \"LIQUID\";\n    M_φ = 1.0,\n    κ = 1.0,\n    W = 1.0,\n    D_s = 1e-13,\n    D_l = 1e-9\n)","category":"section"},{"location":"integration/calphad/#Thermodynamic-Functions","page":"CALPHAD Coupling","title":"Thermodynamic Functions","text":"","category":"section"},{"location":"integration/calphad/#Driving-Force","page":"CALPHAD Coupling","title":"Driving Force","text":"# Gibbs energy difference: ΔG = G_solid - G_liquid\n# Negative ΔG means solid is stable\nΔG = calphad_driving_force(db, T, x, \"FCC_A1\", \"LIQUID\")","category":"section"},{"location":"integration/calphad/#Chemical-Potential","page":"CALPHAD Coupling","title":"Chemical Potential","text":"# Get chemical potentials for a phase\nμ = calphad_chemical_potential(db, \"FCC_A1\", T, x)","category":"section"},{"location":"integration/calphad/#Diffusion-Potential","page":"CALPHAD Coupling","title":"Diffusion Potential","text":"# Second derivative d²G/dx² (thermodynamic factor)\nd2G = calphad_diffusion_potential(db, \"FCC_A1\", T, x)","category":"section"},{"location":"integration/calphad/#API-Reference","page":"CALPHAD Coupling","title":"API Reference","text":"","category":"section"},{"location":"integration/calphad/#See-Also","page":"CALPHAD Coupling","title":"See Also","text":"381calphadcoupling_demo.jl - Complete CALPHAD coupling demo with plots","category":"section"},{"location":"integration/calphad/#PhaseFields.AbstractCALPHADCoupledModel","page":"CALPHAD Coupling","title":"PhaseFields.AbstractCALPHADCoupledModel","text":"AbstractCALPHADCoupledModel\n\nAbstract type for phase field models with CALPHAD thermodynamic coupling. Concrete implementations are provided by the OpenCALPHAD extension.\n\n\n\n\n\n","category":"type"},{"location":"integration/calphad/#PhaseFields.calphad_driving_force","page":"CALPHAD Coupling","title":"PhaseFields.calphad_driving_force","text":"calphad_driving_force(db, T, x, solid_phase, liquid_phase)\n\nCalculate the thermodynamic driving force for solidification using CALPHAD data.\n\nRequires OpenCALPHAD.jl: Load with using OpenCALPHAD to enable this function.\n\nArguments\n\ndb: OpenCALPHAD Database object\nT: Temperature [K]\nx: Composition (mole fraction of solute)\nsolid_phase: Name of solid phase (e.g., \"FCC_A1\")\nliquid_phase: Name of liquid phase (e.g., \"LIQUID\")\n\nReturns\n\nDriving force ΔG [J/mol] (negative = solid stable)\n\n\n\n\n\n","category":"function"},{"location":"integration/calphad/#PhaseFields.calphad_chemical_potential","page":"CALPHAD Coupling","title":"PhaseFields.calphad_chemical_potential","text":"calphad_chemical_potential(db, phase, T, x)\n\nGet chemical potentials from CALPHAD database.\n\nRequires OpenCALPHAD.jl: Load with using OpenCALPHAD to enable this function.\n\nReturns\n\nTuple of chemical potentials (μ₁, μ₂, ...) [J/mol]\n\n\n\n\n\n","category":"function"},{"location":"integration/calphad/#PhaseFields.calphad_diffusion_potential","page":"CALPHAD Coupling","title":"PhaseFields.calphad_diffusion_potential","text":"calphad_diffusion_potential(db, phase, T, x)\n\nGet second derivative of Gibbs energy d²G/dx² from CALPHAD.\n\nRequires OpenCALPHAD.jl: Load with using OpenCALPHAD to enable this function.\n\nReturns\n\nd²G/dx² [J/mol]\n\n\n\n\n\n","category":"function"},{"location":"integration/calphad/#PhaseFields.create_calphad_allen_cahn","page":"CALPHAD Coupling","title":"PhaseFields.create_calphad_allen_cahn","text":"create_calphad_allen_cahn(db, T, x, solid_phase, liquid_phase; kwargs...)\n\nCreate an Allen-Cahn model coupled with CALPHAD thermodynamics.\n\nRequires OpenCALPHAD.jl: Load with using OpenCALPHAD to enable this function.\n\nArguments\n\ndb: OpenCALPHAD Database object\nT: Temperature [K]\nx: Composition (mole fraction)\nsolid_phase: Name of solid phase\nliquid_phase: Name of liquid phase\n\nKeyword Arguments\n\nτ: Relaxation time [s] (default: 1.0)\nW: Interface width parameter (default: 1.0)\nm: Scaling factor for ΔG (default: 1e-4)\n\nReturns\n\nCALPHADAllenCahnModel with cached driving force\n\n\n\n\n\n","category":"function"},{"location":"integration/calphad/#PhaseFields.create_calphad_kks_model","page":"CALPHAD Coupling","title":"PhaseFields.create_calphad_kks_model","text":"create_calphad_kks_model(db, T, solid_phase, liquid_phase; kwargs...)\n\nCreate a KKS model setup with CALPHAD free energies.\n\nRequires OpenCALPHAD.jl: Load with using OpenCALPHAD to enable this function.\n\nArguments\n\ndb: OpenCALPHAD Database object\nT: Temperature [K]\nsolid_phase: Name of solid phase\nliquid_phase: Name of liquid phase\n\nKeyword Arguments\n\nτ: Relaxation time [s] (default: 1.0)\nW: Interface width parameter (default: 1.0)\nm: Driving force scale (default: 1.0)\nM_s: Solid mobility (default: 1.0)\nM_l: Liquid mobility (default: 10.0)\n\nReturns\n\nTuple of (KKSModel, CALPHADFreeEnergysolid, CALPHADFreeEnergyliquid)\n\n\n\n\n\n","category":"function"},{"location":"integration/calphad/#PhaseFields.create_calphad_wbm_model","page":"CALPHAD Coupling","title":"PhaseFields.create_calphad_wbm_model","text":"create_calphad_wbm_model(db, T, solid_phase, liquid_phase; kwargs...)\n\nCreate a WBM model setup with CALPHAD free energies.\n\nRequires OpenCALPHAD.jl: Load with using OpenCALPHAD to enable this function.\n\nArguments\n\ndb: OpenCALPHAD Database object\nT: Temperature [K]\nsolid_phase: Name of solid phase\nliquid_phase: Name of liquid phase\n\nKeyword Arguments\n\nM_φ: Phase field mobility (default: 1.0)\nκ: Gradient energy coefficient (default: 1.0)\nW: Barrier height (default: 1.0)\nD_s: Solid diffusivity (default: 1e-13)\nD_l: Liquid diffusivity (default: 1e-9)\n\nReturns\n\nTuple of (WBMModel, CALPHADFreeEnergysolid, CALPHADFreeEnergyliquid)\n\n\n\n\n\n","category":"function"},{"location":"models/allen_cahn/#Allen-Cahn-Model","page":"Allen-Cahn","title":"Allen-Cahn Model","text":"","category":"section"},{"location":"models/allen_cahn/#Overview","page":"Allen-Cahn","title":"Overview","text":"The Allen-Cahn equation describes the evolution of a non-conserved order parameter. It is widely used for modeling solidification, grain growth, and phase transformations.\n\nThe phase field variable φ represents:\n\nφ = 1: Solid phase\nφ = 0: Liquid phase\n0 < φ < 1: Diffuse interface","category":"section"},{"location":"models/allen_cahn/#Mathematical-Formulation","page":"Allen-Cahn","title":"Mathematical Formulation","text":"The Allen-Cahn equation:\n\ntau fracpartial phipartial t = W^2 nabla^2 phi - g(phi) + m cdot h(phi) cdot Delta G\n\nwhere:\n\nτ: Relaxation time [s]\nW: Interface width parameter\ng(φ): Double-well potential (e.g., φ²(1-φ)²)\nh(φ): Interpolation function (e.g., 3φ² - 2φ³)\nΔG: Thermodynamic driving force [J/mol]\nm: Scaling factor for driving force","category":"section"},{"location":"models/allen_cahn/#Quick-Example","page":"Allen-Cahn","title":"Quick Example","text":"","category":"section"},{"location":"models/allen_cahn/#Basic-Usage","page":"Allen-Cahn","title":"Basic Usage","text":"using PhaseFields\n\n# Create model\nmodel = AllenCahnModel(τ=1.0, W=1.0, m=0.1)\n\n# Compute right-hand side\nφ = 0.5\n∇²φ = -0.1  # Laplacian\nΔG = -100.0  # Driving force (negative = solidification)\n\ndφdt = allen_cahn_rhs(model, φ, ∇²φ, ΔG)","category":"section"},{"location":"models/allen_cahn/#With-DifferentialEquations.jl","page":"Allen-Cahn","title":"With DifferentialEquations.jl","text":"using PhaseFields\nusing OrdinaryDiffEq\n\n# Model and grid\nmodel = AllenCahnModel(τ=1.0, W=0.05)\ngrid = UniformGrid1D(N=101, L=1.0)\nbc = NeumannBC()\n\n# Initial condition: tanh interface\nx0 = 0.3\nφ0 = [0.5 * (1 - tanh((x - x0) / (2 * model.W))) for x in grid.x]\n\n# Create and solve ODE problem\nprob = create_allen_cahn_problem(model, grid, bc, φ0, (0.0, 2.0))\nsol = solve(prob, Tsit5())","category":"section"},{"location":"models/allen_cahn/#API-Reference","page":"Allen-Cahn","title":"API Reference","text":"","category":"section"},{"location":"models/allen_cahn/#See-Also","page":"Allen-Cahn","title":"See Also","text":"101allencahn_1d.jl - Basic 1D evolution\n151diffeqallen_cahn.jl - With DifferentialEquations.jl callbacks","category":"section"},{"location":"models/allen_cahn/#PhaseFields.AllenCahnModel","page":"Allen-Cahn","title":"PhaseFields.AllenCahnModel","text":"AllenCahnModel(; τ=1.0, W=1.0, m=1.0)\n\nAllen-Cahn model for non-conserved order parameter evolution.\n\nThe Allen-Cahn equation:     τ ∂φ/∂t = W²∇²φ - g'(φ) + m·ΔG·h'(φ)\n\nwhere:\n\nφ: Order parameter (0 = solid, 1 = liquid)\nτ: Relaxation time [s]\nW: Interface width parameter [m]\ng(φ): Double-well potential\nh(φ): Interpolation function\nΔG: Driving force [J/mol]\nm: Driving force coupling constant\n\nFields\n\nτ::Float64: Relaxation time [s] (default: 1.0)\nW::Float64: Interface width parameter [m] (default: 1.0)\nm::Float64: Driving force scale [-] (default: 1.0)\n\nExample\n\nmodel = AllenCahnModel()                    # all defaults\nmodel = AllenCahnModel(τ=3e-8, W=1e-6)      # partial\nmodel = AllenCahnModel(τ=3e-8, W=1e-6, m=1.0)  # full\n\n\n\n\n\n","category":"type"},{"location":"models/allen_cahn/#PhaseFields.allen_cahn_rhs","page":"Allen-Cahn","title":"PhaseFields.allen_cahn_rhs","text":"allen_cahn_rhs(model::AllenCahnModel, φ::T, ∇²φ::T, ΔG::T) where T<:Real\n\nCompute the right-hand side of the Allen-Cahn equation.\n\n∂φ/∂t = (W²∇²φ - g'(φ) + m·ΔG·h'(φ)) / τ\n\nThis function is AD-compatible for sensitivity analysis.\n\nArguments\n\nmodel: AllenCahnModel parameters\nφ: Order parameter at current point\n∇²φ: Laplacian of order parameter\nΔG: Driving force [J/mol]\n\nReturns\n\nTime derivative ∂φ/∂t [1/s]\n\nExample\n\nmodel = AllenCahnModel(τ=3e-8, W=1e-6, m=1.0)\ndφdt = allen_cahn_rhs(model, 0.5, -100.0, -5000.0)\n\n\n\n\n\nallen_cahn_rhs(model::AllenCahnModel, φ, ∇²φ, ΔG)\n\nNon-typed version for convenience.\n\n\n\n\n\n","category":"function"},{"location":"models/allen_cahn/#PhaseFields.AllenCahnODEParams","page":"Allen-Cahn","title":"PhaseFields.AllenCahnODEParams","text":"AllenCahnODEParams{M, G, BC, A}\n\nParameters for Allen-Cahn ODE integration.\n\nType Parameters\n\nM: Model type\nG: Grid type (UniformGrid1D or UniformGrid2D)\nBC: Boundary condition type\nA: Laplacian workspace array type\n\nFields\n\nmodel::M: Phase field model parameters\ngrid::G: Spatial discretization (1D or 2D)\nbc::BC: Boundary conditions\n∇²φ::A: Pre-allocated Laplacian workspace\n\n\n\n\n\n","category":"type"},{"location":"models/allen_cahn/#PhaseFields.allen_cahn_ode!","page":"Allen-Cahn","title":"PhaseFields.allen_cahn_ode!","text":"allen_cahn_ode!(dφ, φ, p::AllenCahnODEParams, t)\n\nIn-place RHS function for Allen-Cahn equation compatible with OrdinaryDiffEq.jl.\n\nComputes: dφ/dt = (W²∇²φ - g'(φ)) / τ\n\nWorks with both 1D and 2D grids. For 2D, input/output vectors are automatically reshaped to/from matrices for Laplacian computation.\n\n\n\n\n\n","category":"function"},{"location":"models/allen_cahn/#PhaseFields.create_allen_cahn_problem","page":"Allen-Cahn","title":"PhaseFields.create_allen_cahn_problem","text":"create_allen_cahn_problem(model, grid, bc, φ0, tspan)\n\nCreate ODEProblem for Allen-Cahn equation.\n\nArguments\n\nmodel::AllenCahnModel: Phase field model\ngrid::UniformGrid1D: Spatial grid\nbc::BoundaryCondition: Boundary conditions\nφ0: Initial condition\ntspan: Time span (tstart, tend)\n\nReturns\n\nODEProblem ready for solve()\n\nExample\n\nusing OrdinaryDiffEq\n\nmodel = AllenCahnModel(τ=1.0, W=0.1)\ngrid = UniformGrid1D(N=100, L=1.0)\nφ0 = [0.5 + 0.1*sin(2π*x) for x in grid.x]\n\nprob = create_allen_cahn_problem(model, grid, NeumannBC(), φ0, (0.0, 10.0))\nsol = solve(prob, Tsit5())\n\n\n\n\n\ncreate_allen_cahn_problem(model, grid::UniformGrid2D, bc, φ0, tspan)\n\nCreate ODEProblem for 2D Allen-Cahn equation.\n\nArguments\n\nmodel::AllenCahnModel: Phase field model\ngrid::UniformGrid2D: 2D spatial grid\nbc::BoundaryCondition: Boundary conditions\nφ0::AbstractMatrix: Initial condition (Nx × Ny matrix)\ntspan: Time span (tstart, tend)\n\nReturns\n\nODEProblem ready for solve()\n\nNote\n\nThe initial condition matrix is vectorized column-major (Julia default). Solution vectors can be reshaped back using reshape(sol.u[i], grid.Nx, grid.Ny).\n\nExample\n\nusing OrdinaryDiffEq\n\nmodel = AllenCahnModel(τ=1.0, W=0.1)\ngrid = UniformGrid2D(Nx=50, Ny=50, Lx=1.0, Ly=1.0)\n\n# Circular interface\nφ0 = [sqrt((x-0.5)^2 + (y-0.5)^2) < 0.3 ? 1.0 : 0.0 for x in grid.x, y in grid.y]\n\nprob = create_allen_cahn_problem(model, grid, NeumannBC(), φ0, (0.0, 1.0))\nsol = solve(prob, Tsit5())\n\n# Reshape solution\nφ_final = reshape(sol.u[end], grid.Nx, grid.Ny)\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#WBM-Model-(Wheeler-Boettinger-McFadden)","page":"WBM","title":"WBM Model (Wheeler-Boettinger-McFadden)","text":"","category":"section"},{"location":"models/wbm/#Overview","page":"WBM","title":"Overview","text":"The WBM model is designed for dilute alloy solidification. It couples phase field evolution with solute diffusion using a mixture rule for free energy.\n\nReference: Wheeler, Boettinger, McFadden, Phys. Rev. A 45, 7424 (1992)","category":"section"},{"location":"models/wbm/#Mathematical-Formulation","page":"WBM","title":"Mathematical Formulation","text":"","category":"section"},{"location":"models/wbm/#Total-Free-Energy","page":"WBM","title":"Total Free Energy","text":"F = int left f(phi c T) + frackappa2 nablaphi^2 right dV","category":"section"},{"location":"models/wbm/#Bulk-Free-Energy-(Mixture-Rule)","page":"WBM","title":"Bulk Free Energy (Mixture Rule)","text":"f = h(phi) f_S(c T) + (1 - h(phi)) f_L(c T) + W g(phi)","category":"section"},{"location":"models/wbm/#Phase-Field-Equation","page":"WBM","title":"Phase Field Equation","text":"fracpartial phipartial t = M_phi left kappa nabla^2 phi - h(phi)(f_S - f_L) - W g(phi) right","category":"section"},{"location":"models/wbm/#Concentration-Equation","page":"WBM","title":"Concentration Equation","text":"fracpartial cpartial t = nabla cdot left D(phi) nabla c right\n\nwhere diffusivity interpolates between phases:\n\nD(phi) = h(phi) D_S + (1 - h(phi)) D_L","category":"section"},{"location":"models/wbm/#Quick-Example","page":"WBM","title":"Quick Example","text":"","category":"section"},{"location":"models/wbm/#Basic-Usage","page":"WBM","title":"Basic Usage","text":"using PhaseFields\n\n# Create model\nmodel = WBMModel(\n    M_φ = 1.0,      # Phase field mobility\n    κ = 1.0,        # Gradient coefficient\n    W = 1.0,        # Barrier height\n    D_s = 1e-13,    # Solid diffusivity [m²/s]\n    D_l = 1e-9      # Liquid diffusivity [m²/s]\n)\n\n# Free energies (parabolic for testing)\nf_s = ParabolicFreeEnergy(A=1.0, c_eq=0.2)\nf_l = ParabolicFreeEnergy(A=1.0, c_eq=0.8)\n\n# Compute driving force\nφ = 0.5\nc = 0.5\nΔf = wbm_driving_force(f_s, f_l, c)\n\n# Interpolated diffusivity\nD = wbm_diffusivity(model, φ)","category":"section"},{"location":"models/wbm/#Interface-Properties","page":"WBM","title":"Interface Properties","text":"# Interface width (from κ and W)\nW_int = wbm_interface_width(model)\n\n# Interface energy\nσ = wbm_interface_energy(model)","category":"section"},{"location":"models/wbm/#With-CALPHAD","page":"WBM","title":"With CALPHAD","text":"using PhaseFields\nusing OpenCALPHAD\n\ndb = read_tdb(\"AgCu.TDB\")\nT = 1000.0\n\nmodel, f_s, f_l = create_calphad_wbm_model(db, T, \"FCC_A1\", \"LIQUID\")","category":"section"},{"location":"models/wbm/#API-Reference","page":"WBM","title":"API Reference","text":"","category":"section"},{"location":"models/wbm/#See-Also","page":"WBM","title":"See Also","text":"302wbmsolidification.jl - WBM solidification simulation\n303wbmwheeler1992.jl - Validation vs Wheeler 1992 paper","category":"section"},{"location":"models/wbm/#PhaseFields.WBMModel","page":"WBM","title":"PhaseFields.WBMModel","text":"WBMModel\n\nWheeler-Boettinger-McFadden model for binary alloy solidification.\n\nThe WBM model uses a single concentration field with phase-dependent free energy:     f(φ,c) = h(φ)·fS(c) + (1-h(φ))·fL(c) + W·g(φ)\n\nEvolution equations:\n\nPhase field:   ∂φ/∂t = M_φ[κ∇²φ - h'(φ)(f_S - f_L) - W·g'(φ)]\nConcentration: ∂c/∂t = ∇·[D(φ)·∇c]\n\nFields\n\nM_φ::Float64: Phase field mobility [m³/(J·s)]\nκ::Float64: Gradient energy coefficient [J/m]\nW::Float64: Barrier height [J/m³]\nD_s::Float64: Solid diffusivity [m²/s]\nD_l::Float64: Liquid diffusivity [m²/s]\n\nExample\n\nmodel = WBMModel(M_φ=1.0, κ=1.0, W=1.0, D_s=1e-13, D_l=1e-9)\n\nComparison with KKS\n\nWBM: Single concentration field, c = cS = cL at interface (simpler but interface-width dependent)\nKKS: Separate phase concentrations with equal chemical potential (thermodynamically consistent)\n\nReference\n\nWheeler, Boettinger, McFadden, Phys. Rev. A 45, 7424 (1992)\n\n\n\n\n\n","category":"type"},{"location":"models/wbm/#PhaseFields.wbm_bulk_free_energy","page":"WBM","title":"PhaseFields.wbm_bulk_free_energy","text":"wbm_bulk_free_energy(f_s, f_l, φ, c, W)\n\nCompute the bulk free energy density for WBM model.\n\nf(φ,c) = h(φ)·f_S(c) + (1-h(φ))·f_L(c) + W·g(φ)\n\nArguments\n\nf_s: Solid phase free energy function\nf_l: Liquid phase free energy function\nφ: Phase field value (0=liquid, 1=solid)\nc: Concentration\nW: Barrier height [J/m³]\n\nReturns\n\nBulk free energy density [J/m³]\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_chemical_potential","page":"WBM","title":"PhaseFields.wbm_chemical_potential","text":"wbm_chemical_potential(f_s, f_l, φ, c)\n\nCompute the chemical potential for WBM model.\n\nμ = ∂f/∂c = h(φ)·μ_S(c) + (1-h(φ))·μ_L(c)\n\nArguments\n\nf_s: Solid phase free energy function\nf_l: Liquid phase free energy function\nφ: Phase field value\nc: Concentration\n\nReturns\n\nChemical potential [J/mol]\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_driving_force","page":"WBM","title":"PhaseFields.wbm_driving_force","text":"wbm_driving_force(f_s, f_l, φ, c, W)\n\nCompute the phase field driving force for WBM model.\n\n∂f/∂φ = h'(φ)·(f_S(c) - f_L(c)) + W·g'(φ)\n\nArguments\n\nf_s: Solid phase free energy function\nf_l: Liquid phase free energy function\nφ: Phase field value\nc: Concentration\nW: Barrier height [J/m³]\n\nReturns\n\nDriving force ∂f/∂φ [J/m³]\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_phase_rhs","page":"WBM","title":"PhaseFields.wbm_phase_rhs","text":"wbm_phase_rhs(model, φ, ∇²φ, c, f_s, f_l)\n\nCompute the right-hand side of the WBM phase field equation.\n\n∂φ/∂t = M_φ[κ∇²φ - h'(φ)(f_S - f_L) - W·g'(φ)]\n      = M_φ[κ∇²φ - ∂f/∂φ]\n\nArguments\n\nmodel: WBMModel parameters\nφ: Phase field value\n∇²φ: Laplacian of phase field\nc: Concentration\nf_s: Solid phase free energy function\nf_l: Liquid phase free energy function\n\nReturns\n\nTime derivative ∂φ/∂t\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_concentration_rhs","page":"WBM","title":"PhaseFields.wbm_concentration_rhs","text":"wbm_concentration_rhs(model, φ, ∇²c)\n\nCompute the right-hand side of the WBM concentration equation (simplified form).\n\n∂c/∂t = ∇·[D(φ)·∇c] ≈ D(φ)·∇²c  (for slowly varying D)\n\nArguments\n\nmodel: WBMModel parameters\nφ: Phase field value (for diffusivity interpolation)\n∇²c: Laplacian of concentration\n\nReturns\n\nTime derivative ∂c/∂t\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_diffusivity","page":"WBM","title":"PhaseFields.wbm_diffusivity","text":"wbm_diffusivity(model, φ)\n\nCompute effective diffusivity using interpolation.\n\nD(φ) = h(φ)·D_s + (1-h(φ))·D_l\n\nReturns\n\nEffective diffusivity at this phase field value [m²/s]\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_interface_width","page":"WBM","title":"PhaseFields.wbm_interface_width","text":"wbm_interface_width(model)\n\nEstimate the equilibrium interface width from model parameters.\n\nδ ≈ √(κ/W)\n\nReference\n\nWheeler 1992, Eq. 32: δ = ε√(2/W), where κ = ε²/2\n\n\n\n\n\n","category":"function"},{"location":"models/wbm/#PhaseFields.wbm_interface_energy","page":"WBM","title":"PhaseFields.wbm_interface_energy","text":"wbm_interface_energy(model)\n\nEstimate the interface energy from model parameters.\n\nσ ≈ √(κ·W) / (6√2)\n\nReference\n\nWheeler 1992, Eq. 28: σ = ε√W / (6√2), where κ = ε²/2\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#Common-API-Reference","page":"Reference","title":"Common API Reference","text":"This page documents the common types and functions shared across all phase field models.","category":"section"},{"location":"reference/common/#Types","page":"Reference","title":"Types","text":"","category":"section"},{"location":"reference/common/#Interface-Parameters","page":"Reference","title":"Interface Parameters","text":"","category":"section"},{"location":"reference/common/#Diffusion-Parameters","page":"Reference","title":"Diffusion Parameters","text":"","category":"section"},{"location":"reference/common/#Material-Parameters","page":"Reference","title":"Material Parameters","text":"","category":"section"},{"location":"reference/common/#Interpolation-Functions","page":"Reference","title":"Interpolation Functions","text":"Phase field models use interpolation functions h(φ) and double-well potentials g(φ) to smoothly transition between phases.","category":"section"},{"location":"reference/common/#Interpolation-h(φ)","page":"Reference","title":"Interpolation h(φ)","text":"Properties:\n\nh(0) = 0, h(1) = 1\nSmooth transition in interface region\n\nusing PhaseFields\n\nφ = 0.5\n\n# Polynomial: h = 3φ² - 2φ³\nh = h_polynomial(φ)\n\n# Sinusoidal: h = (1 - cos(πφ))/2\nh = h_sin(φ)\n\n# Derivative\ndh = h_prime(φ)","category":"section"},{"location":"reference/common/#Double-Well-g(φ)","page":"Reference","title":"Double-Well g(φ)","text":"Properties:\n\ng(0) = g(1) = 0\nMaximum at φ = 0.5\nProvides energy barrier\n\n# Standard: g = φ²(1-φ)²\ng = g_standard(φ)\n\n# Obstacle: g = |φ(1-φ)|\ng = g_obstacle(φ)\n\n# Derivatives\ndg = g_prime(φ)\nd2g = g_double_prime(φ)","category":"section"},{"location":"reference/common/#Anisotropy-Functions","page":"Reference","title":"Anisotropy Functions","text":"For dendritic growth, crystallographic anisotropy modifies the interface energy and kinetics.","category":"section"},{"location":"reference/common/#Cubic-Anisotropy-(4-fold)","page":"Reference","title":"Cubic Anisotropy (4-fold)","text":"For FCC and BCC crystals:\n\nθ = π/4  # Angle\n\n# 4-fold anisotropy: a(θ) = 1 + ε cos(4θ)\na = anisotropy_cubic(θ; ε=0.05)","category":"section"},{"location":"reference/common/#HCP-Anisotropy-(6-fold)","page":"Reference","title":"HCP Anisotropy (6-fold)","text":"For hexagonal crystals:\n\n# 6-fold anisotropy: a(θ) = 1 + ε cos(6θ)\na = anisotropy_hcp(θ; ε=0.05)","category":"section"},{"location":"reference/common/#Custom-Anisotropy","page":"Reference","title":"Custom Anisotropy","text":"# n-fold anisotropy\na = anisotropy_custom(θ; ε=0.05, n=8)","category":"section"},{"location":"reference/common/#AD-Configuration","page":"Reference","title":"AD Configuration","text":"PhaseFields.jl uses DifferentiationInterface.jl for automatic differentiation.","category":"section"},{"location":"reference/common/#Module","page":"Reference","title":"Module","text":"","category":"section"},{"location":"reference/common/#PhaseFields.InterfaceParams","page":"Reference","title":"PhaseFields.InterfaceParams","text":"InterfaceParams\n\nParameters for solid-liquid interface modeling.\n\nFields\n\nW₀::Float64: Interface width parameter [m]\nσ₀::Float64: Interface energy [J/m²]\nτ::Float64: Relaxation time [s]\nδ::Float64: Anisotropy strength [-]\nn_fold::Int: Anisotropy symmetry (4=FCC, 6=HCP)\n\nExample\n\n# FCC metal with 4-fold anisotropy\nparams = InterfaceParams(\n    W₀ = 1e-6,    # 1 μm interface width\n    σ₀ = 0.3,     # 0.3 J/m² interface energy\n    τ = 3e-8,     # 30 ns relaxation time\n    δ = 0.04,     # 4% anisotropy\n    n_fold = 4    # 4-fold cubic symmetry\n)\n\n\n\n\n\n","category":"type"},{"location":"reference/common/#PhaseFields.DiffusionParams","page":"Reference","title":"PhaseFields.DiffusionParams","text":"DiffusionParams\n\nTemperature-dependent diffusion parameters.\n\nFields\n\nD_liquid::Float64: Pre-exponential factor for liquid [m²/s]\nD_solid::Float64: Pre-exponential factor for solid [m²/s]\nQ_liquid::Float64: Activation energy for liquid [J/mol]\nQ_solid::Float64: Activation energy for solid [J/mol]\n\nExample\n\nparams = DiffusionParams(\n    D_liquid = 1e-9,  # m²/s\n    D_solid = 1e-13,  # m²/s\n    Q_liquid = 40e3,  # 40 kJ/mol\n    Q_solid = 80e3    # 80 kJ/mol\n)\n\n\n\n\n\n","category":"type"},{"location":"reference/common/#PhaseFields.MaterialParams","page":"Reference","title":"PhaseFields.MaterialParams","text":"MaterialParams\n\nGeneral material properties.\n\nFields\n\nVm::Float64: Molar volume [m³/mol]\nL::Float64: Latent heat [J/mol]\nCp::Float64: Heat capacity [J/(mol·K)]\nk::Float64: Thermal conductivity [W/(m·K)]\n\n\n\n\n\n","category":"type"},{"location":"reference/common/#PhaseFields.h_polynomial","page":"Reference","title":"PhaseFields.h_polynomial","text":"h_polynomial(φ::T) where T<:Real\n\nPolynomial interpolation function h(φ) = 3φ² - 2φ³.\n\nMost commonly used interpolation for phase field models. Properties: h(0) = 0, h(1) = 1, h'(0) = h'(1) = 0.\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nInterpolated value ∈ [0, 1]\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.h_sin","page":"Reference","title":"PhaseFields.h_sin","text":"h_sin(φ::T) where T<:Real\n\nSinusoidal interpolation function h(φ) = (1 - cos(πφ))/2.\n\nAlternative interpolation with similar properties to polynomial. Properties: h(0) = 0, h(1) = 1, h'(0) = h'(1) = 0.\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nInterpolated value ∈ [0, 1]\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.h_prime","page":"Reference","title":"PhaseFields.h_prime","text":"h_prime(φ::T) where T<:Real\n\nDerivative of polynomial interpolation: h'(φ) = 6φ(1-φ).\n\nAnalytical form for better performance than AD.\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nDerivative value\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.g_standard","page":"Reference","title":"PhaseFields.g_standard","text":"g_standard(φ::T) where T<:Real\n\nStandard double-well potential g(φ) = φ²(1-φ)².\n\nProperties: g(0) = g(1) = 0, minimum at φ = 0 and φ = 1. Maximum at φ = 0.5 with g(0.5) = 1/16.\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nPotential value ≥ 0\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.g_obstacle","page":"Reference","title":"PhaseFields.g_obstacle","text":"g_obstacle(φ::T) where T<:Real\n\nObstacle double-well potential g(φ) = φ(1-φ).\n\nSimpler form than standard, but with same zeros. Used in some thin-interface models.\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nPotential value ≥ 0\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.g_prime","page":"Reference","title":"PhaseFields.g_prime","text":"g_prime(φ::T) where T<:Real\n\nDerivative of standard double-well: g'(φ) = 2φ(1-φ)(1-2φ).\n\nAnalytical form for better performance than AD.\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nDerivative value\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.g_double_prime","page":"Reference","title":"PhaseFields.g_double_prime","text":"g_double_prime(φ::T) where T<:Real\n\nSecond derivative of standard double-well: g''(φ) = 2(1 - 6φ + 6φ²).\n\nArguments\n\nφ: Order parameter ∈ [0, 1]\n\nReturns\n\nSecond derivative value\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.anisotropy_cubic","page":"Reference","title":"PhaseFields.anisotropy_cubic","text":"anisotropy_cubic(θ::T; δ::Real=0.04) where T<:Real\n\n4-fold anisotropic interface energy for FCC/BCC crystals.\n\nσ(θ) = 1 + δ·cos(4θ)\n\nArguments\n\nθ: Interface normal angle [rad]\nδ: Anisotropy strength (default: 0.04 = 4%)\n\nReturns\n\nNormalized interface energy (base value = 1)\n\nExample\n\n# Interface energy at θ = 0 (⟨100⟩ direction)\nσ = anisotropy_cubic(0.0, δ=0.04)  # = 1.04\n\n# Interface energy at θ = π/4 (⟨110⟩ direction)\nσ = anisotropy_cubic(π/4, δ=0.04)  # = 0.96\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.anisotropy_hcp","page":"Reference","title":"PhaseFields.anisotropy_hcp","text":"anisotropy_hcp(θ::T; δ::Real=0.02) where T<:Real\n\n6-fold anisotropic interface energy for HCP crystals.\n\nσ(θ) = 1 + δ·cos(6θ)\n\nArguments\n\nθ: Interface normal angle [rad]\nδ: Anisotropy strength (default: 0.02 = 2%)\n\nReturns\n\nNormalized interface energy (base value = 1)\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.anisotropy_custom","page":"Reference","title":"PhaseFields.anisotropy_custom","text":"anisotropy_custom(θ::T; n::Int, δ::Real) where T<:Real\n\nn-fold anisotropic interface energy.\n\nσ(θ) = 1 + δ·cos(n·θ)\n\nArguments\n\nθ: Interface normal angle [rad]\nn: Symmetry order (4 for cubic, 6 for hexagonal)\nδ: Anisotropy strength\n\nReturns\n\nNormalized interface energy (base value = 1)\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields.DEFAULT_AD_BACKEND","page":"Reference","title":"PhaseFields.DEFAULT_AD_BACKEND","text":"Default AD backend (ForwardDiff). Can be changed via set_ad_backend!.\n\n\n\n\n\n","category":"constant"},{"location":"reference/common/#PhaseFields.set_ad_backend!","page":"Reference","title":"PhaseFields.set_ad_backend!","text":"set_ad_backend!(backend)\n\nSet the default AD backend for PhaseFields.jl.\n\nArguments\n\nbackend: A DifferentiationInterface backend (e.g., DI.AutoForwardDiff())\n\nExample\n\nusing DifferentiationInterface\nset_ad_backend!(DI.AutoForwardDiff())  # Default\n# set_ad_backend!(DI.AutoEnzyme())     # For high performance (future)\n\n\n\n\n\n","category":"function"},{"location":"reference/common/#PhaseFields","page":"Reference","title":"PhaseFields","text":"PhaseFields.jl\n\nPhase Field method simulation package for materials science. Provides domain-specific functionality for solidification modeling with CALPHAD thermodynamic coupling.\n\nFeatures\n\nInterface modeling (interpolation, double-well, anisotropy)\nPhase field models (Allen-Cahn, Cahn-Hilliard, KKS, WBM)\nCALPHAD coupling via OpenCALPHAD.jl (optional extension)\nAD-compatible design using DifferentiationInterface.jl\n\n\n\n\n\n","category":"module"},{"location":"#PhaseFields.jl","page":"Home","title":"PhaseFields.jl","text":"Phase Field method simulation package for materials science.","category":"section"},{"location":"#Features","page":"Home","title":"Features","text":"Interface modeling: Interpolation functions, double-well potentials, anisotropy\nPhase field models: Allen-Cahn, Cahn-Hilliard, KKS, WBM, Thermal coupling\nCALPHAD coupling: Optional integration with OpenCALPHAD.jl\nDifferentialEquations.jl integration: Method of Lines with adaptive time stepping\nAD-compatible design: Using DifferentiationInterface.jl","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"using Pkg\nPkg.add(url=\"https://github.com/hsugawa8651/PhaseFields.jl\")\n\nFor CALPHAD coupling:\n\nPkg.add(url=\"https://github.com/hsugawa8651/OpenCALPHAD.jl\")","category":"section"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"","category":"section"},{"location":"#Basic-Allen-Cahn-simulation","page":"Home","title":"Basic Allen-Cahn simulation","text":"using PhaseFields\nusing OrdinaryDiffEq\n\n# Create model and grid\nmodel = AllenCahnModel(τ=1.0, W=1.0, m=0.1)\ngrid = UniformGrid1D(100, 10.0)\n\n# Initial condition: tanh interface\nx0 = grid.L / 2\nφ0 = [0.5 * (1 - tanh((x - x0) / 1.0)) for x in grid.x]\n\n# Create and solve ODE problem\nprob = create_allen_cahn_problem(model, grid, NeumannBC(), φ0, (0.0, 10.0))\nsol = solve(prob, Tsit5())","category":"section"},{"location":"#With-CALPHAD-thermodynamics","page":"Home","title":"With CALPHAD thermodynamics","text":"using PhaseFields\nusing OpenCALPHAD  # Activates CALPHAD extension\n\n# Load thermodynamic database\ndb = read_tdb(\"AgCu.TDB\")\n\n# Create CALPHAD-coupled model\nT = 1000.0  # Temperature [K]\nx = 0.3     # Composition (Cu mole fraction)\nmodel = create_calphad_allen_cahn(db, T, x, \"FCC_A1\", \"LIQUID\")\n\n# Driving force from CALPHAD\nΔG = calphad_driving_force(db, T, x, \"FCC_A1\", \"LIQUID\")","category":"section"},{"location":"#Package-Structure","page":"Home","title":"Package Structure","text":"PhaseFields.jl/\n├── src/\n│   ├── PhaseFields.jl       # Main module\n│   ├── types.jl             # Type definitions\n│   ├── interpolation.jl     # h(φ), g(φ) functions\n│   ├── anisotropy.jl        # Anisotropy functions\n│   ├── models/              # Phase field models\n│   │   ├── allen_cahn.jl\n│   │   ├── cahn_hilliard.jl\n│   │   ├── kks.jl\n│   │   ├── wbm.jl\n│   │   └── thermal.jl\n│   └── integration/\n│       └── diffeq.jl        # DifferentialEquations.jl integration\n└── ext/\n    └── OpenCALPHADExt.jl    # CALPHAD coupling extension","category":"section"},{"location":"#Contents","page":"Home","title":"Contents","text":"Pages = [\"getting_started.md\", \"api.md\"]\nDepth = 2","category":"section"},{"location":"models/thermal/#Thermal-Phase-Field-Model","page":"Thermal","title":"Thermal Phase Field Model","text":"","category":"section"},{"location":"models/thermal/#Overview","page":"Thermal","title":"Overview","text":"The thermal phase field model couples solidification with heat transfer, capturing latent heat release and thermal gradients. It is essential for modeling realistic solidification where temperature evolution affects interface kinetics.","category":"section"},{"location":"models/thermal/#Mathematical-Formulation","page":"Thermal","title":"Mathematical Formulation","text":"","category":"section"},{"location":"models/thermal/#Phase-Field-Equation","page":"Thermal","title":"Phase Field Equation","text":"tau fracpartial phipartial t = W^2 nabla^2 phi - g(phi) + lambda h(phi) u","category":"section"},{"location":"models/thermal/#Heat-Equation","page":"Thermal","title":"Heat Equation","text":"fracpartial upartial t = alpha nabla^2 u + frac12 fracpartial phipartial t","category":"section"},{"location":"models/thermal/#Dimensionless-Temperature","page":"Thermal","title":"Dimensionless Temperature","text":"u = fracT - T_mL  C_p\n\nwhere:\n\nT: Physical temperature [K]\nT_m: Melting temperature [K]\nL: Latent heat [J/m³]\nC_p: Heat capacity [J/(m³·K)]\nα: Thermal diffusivity [m²/s]","category":"section"},{"location":"models/thermal/#Stefan-Number","page":"Thermal","title":"Stefan Number","text":"St = fracC_p Delta TL","category":"section"},{"location":"models/thermal/#Quick-Example","page":"Thermal","title":"Quick Example","text":"","category":"section"},{"location":"models/thermal/#Basic-Usage","page":"Thermal","title":"Basic Usage","text":"using PhaseFields\n\n# Create model (nickel-like parameters)\nmodel = ThermalPhaseFieldModel(\n    τ = 1e-6,       # Relaxation time [s]\n    W = 1e-6,       # Interface width [m]\n    λ = 2.0,        # Coupling strength\n    α = 1e-5,       # Thermal diffusivity [m²/s]\n    L = 2.35e9,     # Latent heat [J/m³]\n    Cp = 5.42e6,    # Heat capacity [J/(m³·K)]\n    Tm = 1728.0     # Melting point [K]\n)\n\n# Convert temperature\nT = 1700.0  # Physical temperature [K]\nu = dimensionless_temperature(model, T)\n\n# Convert back\nT_back = physical_temperature(model, u)","category":"section"},{"location":"models/thermal/#With-DifferentialEquations.jl","page":"Thermal","title":"With DifferentialEquations.jl","text":"using PhaseFields\nusing OrdinaryDiffEq\n\nmodel = ThermalPhaseFieldModel(\n    τ=1e-6, W=1e-6, λ=2.0,\n    α=1e-5, L=2.35e9, Cp=5.42e6, Tm=1728.0\n)\n\ngrid = UniformGrid1D(N=101, L=1e-4)\nbc_φ = NeumannBC()\nbc_u = NeumannBC()\n\n# Initial conditions\nφ0 = [x < grid.L/2 ? 1.0 : 0.0 for x in grid.x]  # Solid seed\nu0 = fill(-0.05, grid.N)  # Slight undercooling\n\n# Create and solve\nprob = create_thermal_problem(model, grid, bc_φ, bc_u, φ0, u0, (0.0, 1e-3))\nsol = solve(prob, QNDF(autodiff=false))\n\n# Extract solution\nφ_hist, u_hist = extract_thermal_solution(sol, grid.N)","category":"section"},{"location":"models/thermal/#Stefan-Problem","page":"Thermal","title":"Stefan Problem","text":"The model can simulate the classical Stefan problem where a planar interface advances into an undercooled melt, releasing latent heat.\n\n# Undercooling determines interface velocity\nΔT = 10.0  # [K]\nu0 = dimensionless_temperature(model, model.Tm - ΔT)","category":"section"},{"location":"models/thermal/#API-Reference","page":"Thermal","title":"API Reference","text":"","category":"section"},{"location":"models/thermal/#See-Also","page":"Thermal","title":"See Also","text":"304thermalsolidification.jl - Thermal + phase field coupling\n305stefanproblem_1d.jl - Classical Stefan problem\n351diffeqthermal_solidification.jl - With DifferentialEquations.jl","category":"section"},{"location":"models/thermal/#PhaseFields.ThermalPhaseFieldModel","page":"Thermal","title":"PhaseFields.ThermalPhaseFieldModel","text":"ThermalPhaseFieldModel\n\nParameters for thermal phase field model coupling phase evolution with heat transfer.\n\nFields\n\nτ::Float64: Relaxation time [s]\nW::Float64: Interface width parameter [m]\nλ::Float64: Thermal coupling strength (dimensionless)\nα::Float64: Thermal diffusivity [m²/s]\nL::Float64: Latent heat [J/m³]\nCp::Float64: Volumetric heat capacity [J/(m³·K)]\nTm::Float64: Melting temperature [K]\nK::Float64: Latent heat coefficient L/Cp [K] (computed)\n\nExample\n\nmodel = ThermalPhaseFieldModel(\n    τ = 1.0,\n    W = 1.0,\n    λ = 1.0,\n    α = 1e-5,\n    L = 2.35e9,\n    Cp = 5.42e6,\n    Tm = 1728.0\n)\n\n\n\n\n\n","category":"type"},{"location":"models/thermal/#PhaseFields.dimensionless_temperature","page":"Thermal","title":"PhaseFields.dimensionless_temperature","text":"dimensionless_temperature(T, Tm, L, Cp)\n\nConvert physical temperature to dimensionless temperature.\n\nArguments\n\nT: Physical temperature [K]\nTm: Melting temperature [K]\nL: Latent heat [J/m³]\nCp: Volumetric heat capacity [J/(m³·K)]\n\nReturns\n\nu: Dimensionless temperature u = Cp(T - Tm)/L\n\nNotes\n\nu = 0 at melting point\nu < 0 for undercooling (T < Tm)\nu > 0 for superheating (T > Tm)\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.physical_temperature","page":"Thermal","title":"PhaseFields.physical_temperature","text":"physical_temperature(u, Tm, L, Cp)\n\nConvert dimensionless temperature back to physical temperature.\n\nArguments\n\nu: Dimensionless temperature\nTm: Melting temperature [K]\nL: Latent heat [J/m³]\nCp: Volumetric heat capacity [J/(m³·K)]\n\nReturns\n\nT: Physical temperature [K]\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.stefan_number","page":"Thermal","title":"PhaseFields.stefan_number","text":"stefan_number(ΔT, L, Cp)\n\nCalculate Stefan number.\n\nArguments\n\nΔT: Temperature difference (undercooling or superheating) [K]\nL: Latent heat [J/m³]\nCp: Volumetric heat capacity [J/(m³·K)]\n\nReturns\n\nSt: Stefan number St = Cp·ΔT/L (sensible heat / latent heat ratio)\n\nNotes\n\nSt << 1: Latent heat dominates, slow interface motion\nSt ~ 1: Comparable sensible and latent heat\nSt >> 1: Sensible heat dominates, fast interface motion\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.thermal_phase_rhs","page":"Thermal","title":"PhaseFields.thermal_phase_rhs","text":"thermal_phase_rhs(model, φ, ∇²φ, u)\n\nCompute right-hand side of phase field evolution equation with thermal driving.\n\nArguments\n\nmodel::ThermalPhaseFieldModel: Model parameters\nφ: Phase field value (0=liquid, 1=solid)\n∇²φ: Laplacian of phase field\nu: Dimensionless temperature\n\nReturns\n\n∂φ/∂t: Time derivative of phase field (divide by τ is already done)\n\nEquation\n\nτ ∂φ/∂t = W²∇²φ - g'(φ) + λu h'(φ)\n\nReturns the RHS divided by τ:\n\n∂φ/∂t = (W²∇²φ - g'(φ) + λu h'(φ)) / τ\n\nNotes\n\ng(φ) = φ²(1-φ)² double-well potential, g'(φ) = 2φ(1-φ)(1-2φ)\nh(φ) = φ²(3-2φ) interpolation function, h'(φ) = 6φ(1-φ)\nUndercooling (u < 0) drives solidification (increases φ)\nSuperheating (u > 0) drives melting (decreases φ)\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.thermal_heat_rhs","page":"Thermal","title":"PhaseFields.thermal_heat_rhs","text":"thermal_heat_rhs(model, u, ∇²u, dφdt)\n\nCompute right-hand side of heat equation with latent heat source.\n\nArguments\n\nmodel::ThermalPhaseFieldModel: Model parameters\nu: Dimensionless temperature\n∇²u: Laplacian of dimensionless temperature\ndφdt: Time derivative of phase field\n\nReturns\n\n∂u/∂t: Time derivative of dimensionless temperature\n\nEquation\n\n∂u/∂t = α∇²u + (1/2) ∂φ/∂t\n\nNotes\n\nSolidification (dφdt > 0) releases latent heat (u increases)\nMelting (dφdt < 0) absorbs latent heat (u decreases)\nFactor 1/2 comes from h(φ) normalization where solid fraction = h(φ)\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.thermal_stability_dt","page":"Thermal","title":"PhaseFields.thermal_stability_dt","text":"thermal_stability_dt(model, dx)\n\nCompute stable time step for coupled thermal phase field evolution.\n\nArguments\n\nmodel::ThermalPhaseFieldModel: Model parameters\ndx: Grid spacing [m]\n\nReturns\n\ndt: Stable time step [s]\n\nNotes\n\nCombines stability conditions:\n\nThermal diffusion: dt < dx²/(2α) in 1D, dx²/(4α) in 2D\nPhase field: dt < τ·dx²/(2W²)\n\nReturns conservative (1D) limit with safety factor.\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.ThermalODEParams","page":"Thermal","title":"PhaseFields.ThermalODEParams","text":"ThermalODEParams{M, G, BC1, BC2, A}\n\nParameters for coupled thermal phase field ODE integration.\n\nType Parameters\n\nM: Model type\nG: Grid type (UniformGrid1D or UniformGrid2D)\nBC1: Phase field boundary condition type\nBC2: Temperature boundary condition type\nA: Laplacian workspace array type\n\nFields\n\nmodel::M: Thermal phase field model\ngrid::G: Spatial discretization (1D or 2D)\nbc_φ::BC1: Phase field boundary conditions\nbc_u::BC2: Temperature boundary conditions\n∇²φ::A: Pre-allocated Laplacian workspace for φ\n∇²u::A: Pre-allocated Laplacian workspace for u\ndφdt::A: Pre-allocated dφ/dt workspace\n\n\n\n\n\n","category":"type"},{"location":"models/thermal/#PhaseFields.thermal_ode!","page":"Thermal","title":"PhaseFields.thermal_ode!","text":"thermal_ode!(dy, y, p::ThermalODEParams, t)\n\nIn-place RHS function for coupled thermal phase field equations.\n\nState vector y = [φ; u] where:\n\nφ: Phase field (indices 1:N for 1D, 1:Nx*Ny for 2D)\nu: Dimensionless temperature (indices N+1:2N for 1D)\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.create_thermal_problem","page":"Thermal","title":"PhaseFields.create_thermal_problem","text":"create_thermal_problem(model, grid, bc_φ, bc_u, φ0, u0, tspan)\n\nCreate ODEProblem for coupled thermal phase field equations.\n\nArguments\n\nmodel::ThermalPhaseFieldModel: Thermal phase field model\ngrid::UniformGrid1D: Spatial grid\nbc_φ::BoundaryCondition: Phase field boundary conditions\nbc_u::BoundaryCondition: Temperature boundary conditions\nφ0: Initial phase field\nu0: Initial dimensionless temperature\ntspan: Time span (tstart, tend)\n\nReturns\n\nODEProblem with state vector [φ; u]\n\n\n\n\n\n","category":"function"},{"location":"models/thermal/#PhaseFields.extract_thermal_solution","page":"Thermal","title":"PhaseFields.extract_thermal_solution","text":"extract_thermal_solution(sol, N)\n\nExtract φ and u from thermal ODE solution.\n\nArguments\n\nsol: ODESolution from solve()\nN: Number of grid points\n\nReturns\n\n(φ_history, u_history): Arrays of shape (N, n_times)\n\n\n\n\n\n","category":"function"}]
}
